let inmuebles=[],$body=document.querySelector("#bodyTableInmuebles"),btnSaveInmueble=document.getElementById("btnSaveInmueble"),btnUpdateInmueble=document.getElementById("btnUpdateInmueble"),formInmuebleRegister=document.getElementById("formInmuebleRegister");formInmuebleRegister.addEventListener("submit",ajaxFormRegisterInmuebles);let formInmuebleUpdate=document.getElementById("formInmuebleUpdate");formInmuebleUpdate.addEventListener("submit",ajaxFormUpdateInmuebles);const info=()=>{if(0==inmuebles.length){const a=document.createElement("tr");let b=document.createElement("td");b.setAttribute("colspan",7),b.setAttribute("id","infoTable"),b.textContent="Sin datos",a.appendChild(b),$body.appendChild(a)}},getData=async()=>{try{const a=await axios.get(`${SITEURL}/inmuebles`);inmuebles=Object.values((await a).data),0<inmuebles.length&&(await drawTable(inmuebles,$body,"Inmueble"),null!=document.getElementById("infoTable")&&document.getElementById("infoTable").remove())}catch(a){console.error(a)}};async function ajaxFormRegisterInmuebles(a){a.preventDefault(),btnSaveInmueble.value="Enviando...",btnSaveInmueble.disabled=!0;const b=new FormData(formInmuebleRegister),c=await axios.post(formInmuebleRegister.action,b).then(a=>{refresh(a.data.message),$("#formInmuebleRegister").trigger("reset"),$("#modalInmuebleRegister").modal("hide")}).catch(a=>{if(a.response.data.errors){for(var b in a.response.data.errors){let c=formInmuebleRegister.elements.namedItem(b);c.classList.add("is-invalid"),toastr.error(`<li> ${a.response.data.errors[b]} </li>`)}console.error(a.response.data)}});document.getElementById("btnSaveInmueble").value="Enviar",btnSaveInmueble.disabled=!1}async function ajaxFormUpdateInmuebles(a){a.preventDefault(),btnUpdateInmueble.value="Enviando...",btnUpdateInmueble.disabled=!0;const b=new FormData(formInmuebleUpdate),c=await axios.post(formInmuebleUpdate.action,b).then(a=>{refresh(a.data.message),console.log(a.data),$("#formInmuebleUpdate").trigger("reset"),$("#modalInmuebleUpdate").modal("hide")}).catch(a=>{for(var b in a.response.data.errors){let c=formInmuebleUpdate.elements.namedItem(b);c.classList.add("is-invalid"),warning=document.createTextNode(`${a.response.data.errors[b]}`),insertAfter(warning,c)}});document.getElementById("btnUpdateInmueble").value="Enviar",btnUpdateInmueble.disabled=!1}function eliminarInmueble(a){toastr.options.preventDuplicates=!0,toastr.info("<br /><button class='btn btn-sm btn-danger m-1' type='button' value='yes'>Yes</button> <button class='btn btn-sm btn-warning m-1' type ='button'  value='no' > No </button>","Desea eliminar este elemento ?",{allowHtml:!0,onclick:async function(b){if(value=b.target.value,"yes"==value){const b=`${SITEURL}/inmuebles/${a}`;try{const a=await axios.delete(b);console.log(a),refresh(a.data.data)}catch(a){toastr.remove(),console.error(a)}}else toastr.remove()}})}async function editarInmueble(a){const b=SITEURL+"/inmuebles/"+a,c=await axios.get(b);switch(c.status){case 200:console.log(c),document.getElementById("codigoUpdate").innerText=c.data.data.codigo,formInmuebleUpdate.id.value=c.data.data.id,formInmuebleUpdate.estado.value=c.data.data.estado,formInmuebleUpdate.direccion.value=c.data.data.direccion,formInmuebleUpdate.propietario_id.value=c.data.data.propietario.identificacion,formInmuebleUpdate.ciudad.value=c.data.data.ciudad,formInmuebleUpdate.barrio.value=c.data.data.barrio,formInmuebleUpdate.amoblado.value=c.data.data.amoblado,formInmuebleUpdate.parqueadero.value=c.data.data.parqueadero,formInmuebleUpdate.baños.value=c.data.data.baños,formInmuebleUpdate.departamento.value=c.data.data.departamento,formInmuebleUpdate.administracion.value=c.data.data.administracion,formInmuebleUpdate.comision.value=c.data.data.comision,formInmuebleUpdate.tipo.value=c.data.data.tipo,formInmuebleUpdate.proposito.value=c.data.data.proposito,formInmuebleUpdate.habitaciones.value=c.data.data.habitaciones,formInmuebleUpdate.canon.value=c.data.data.canon,formInmuebleUpdate.descripcion.value=c.data.data.descripcion,formInmuebleUpdate.precio.value=c.data.data.precio,$("#modalInmuebleUpdate").modal("show");break;default:}}const refresh=async a=>{$body.innerHTML="",getData(),await toastr.remove(),await toastr.info("Success:",a)};document.hasFocus()&&(info(),getData());